<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Cross-Domain XMLHttpRequest (XDomainRequest in IE) Example</title>
</head>
<body>

<button id="bt" type="button">Click Me to Issue Cross-Domain XHR!</button>

<script src="xhr.js"></script>
</body>


     <select class="ms-List" id="ListBox"></select>
     
<script>
/**
 * Cross-Browser Cross-Domain XMLHttpRequest (XDomainRequest in IE)
 *
 * @param {string} url The url of HTTP GET (AJAX) request.
 * @param {function} callback The callback function if the request succeeds.
 * @param {function} failCallback The callback function if the request fails.
 */
AJAXRequest = function(url, callback, failCallback) {
  var xmlhttp = new XMLHttpRequest();

  if ("withCredentials" in xmlhttp) {
    xmlhttp.onreadystatechange = function() {
      if (xmlhttp.readyState == 4) {
        if (xmlhttp.status == 200 || xmlhttp.status == 304) {
          callback(xmlhttp.responseText);
        } else {
          setTimeout(failCallback, 0);
        }
      }
    }

    xmlhttp.open("GET", url, true);
    xmlhttp.send();
  }
};

/**
 * Callback function of AJAX request if the request succeeds.
 */
callback = function(responseText) {
  // write your own handler here.
  //alert('result from http://localhost/ProvaCrossDomain/test.json\n' + responseText);

        var jsonFilenameObj = JSON.parse(responseText);
        //var jsonFilenameObj = JSON.parse(Get("https://raw.githubusercontent.com/BananaAccounting/General/master/OfficeAdd-ins/ExcelAddIns/001_Tables/test.json"));
        var len = jsonFilenameObj.length;

        for (var i = 0; i < len; i++)
        {
            var x = document.getElementById("ListBox");
            var option = document.createElement("option");
            option.text = jsonFilenameObj[i];
            x.add(option);
        }
};

/**
 * Callback function of AJAX request if the request fails.
 */
failCallback = function() {
  // write your own failure handler here.
  alert('AJAXRequest failure!');
};


document.getElementById('bt').onclick = function() {
  AJAXRequest('http://localhost/ProvaCrossDomain/test.json', callback, failCallback);
};
</script>

</html>